
import "pkl:semver"

import "shared.pkl" as s

typealias Privilege = "read"|"write"|"publish"|"ultimate"

/// The base definition of a package
///
/// Used to represent schemas such as the `latest` and the types for `versions`
open class ImplPackage {

}

/// Extension of this class for `api/packages`
class GetSchemaPackage extends ImplPackage {

}

/// The major extension of this class
open class Package extends ImplPackage {
    name: String

    scope: String?

    description: String?
    
    version: s.Version

    author: Author

    language: String?

    created_at: String

    updated_at: String?
}

open class VerbosePackage extends Package {
    /// readme info
    readme: String?

    /// info 
    info: Mapping<String, Any>

    /// env
    env: Mapping<String, Any>

    /// metadata
    metadata: Mapping<String, Any>

    /// signatures
    signatures: Listing<Signature>

    /// whether the package is deprecated
    deprecated: Boolean?

    /// whether the package is yanked
    yanked: Boolean?
}


class Signature {
    /// public key id
    public_key_id: String

    /// The signature itself
    signature: String

    /// The time the date was created
    created: String
}

open class Author {
    name: String
    email: String
    avatar: String?
}

class Contributor extends Author {
    /// The role of the contributor
    privileges: Listing<Privilege>?
}